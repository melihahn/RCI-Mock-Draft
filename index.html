<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RCI WINTER GOLF DRAFT</title>
<style>
/* ========== RESET & BASE ========== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --pink: #FF2D9B;
  --pink-glow: rgba(255,45,155,0.5);
  --teal: #00FFCC;
  --teal-glow: rgba(0,255,204,0.5);
  --gold: #FFD700;
  --gold-glow: rgba(255,215,0,0.5);
  --red: #FF3366;
  --violet: #BF5FFF;
  --lime: #AAFF00;
  --bg: #0a0a0a;
  --card-bg: #141414;
  --card-border: #2a2a2a;
  --text: #f0f0f0;
  --text-dim: #999;
}

html { font-size: 18px; }

body {
  font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  background-image:
    radial-gradient(ellipse at 50% 0%, rgba(255,45,155,0.06) 0%, transparent 60%),
    linear-gradient(0deg, rgba(0,255,204,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,204,0.03) 1px, transparent 1px);
  background-size: 100% 100%, 50px 50px, 50px 50px;
}

.screen { display: none; min-height: 100vh; }
.screen.active { display: flex; flex-direction: column; align-items: center; justify-content: center; }

/* ========== TYPOGRAPHY ========== */
.arcade-text {
  text-transform: uppercase;
  letter-spacing: 0.15em;
  font-weight: 900;
}

.fire-text {
  background: linear-gradient(180deg, var(--gold) 0%, var(--pink) 50%, var(--red) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  filter: drop-shadow(0 0 25px rgba(255,45,155,0.6));
}

.teal-text { color: var(--teal); text-shadow: 0 0 15px var(--teal-glow); }
.pink-text { color: var(--pink); text-shadow: 0 0 15px var(--pink-glow); }
.gold-text { color: var(--gold); text-shadow: 0 0 15px var(--gold-glow); }

/* ========== BUTTONS ========== */
.btn {
  display: inline-block;
  padding: 20px 55px;
  font-size: 1.4rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  border: 3px solid var(--pink);
  background: transparent;
  color: var(--pink);
  cursor: pointer;
  transition: all 0.3s;
}

.btn:hover {
  background: var(--pink);
  color: var(--bg);
  box-shadow: 0 0 40px var(--pink-glow), inset 0 0 30px rgba(255,45,155,0.1);
}

.btn-teal { border-color: var(--teal); color: var(--teal); }
.btn-teal:hover { background: var(--teal); color: var(--bg); box-shadow: 0 0 40px var(--teal-glow); }

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.05); }
}

.pulse { animation: pulse 1.5s ease-in-out infinite; }

/* ========== SCREEN 1: TITLE ========== */
#title-screen { gap: 40px; padding: 20px; text-align: center; }

.main-title {
  font-size: clamp(3rem, 8vw, 6rem);
  line-height: 1.1;
}

.subtitle {
  font-size: clamp(1.1rem, 3vw, 1.5rem);
  color: var(--text-dim);
  letter-spacing: 0.3em;
}

.title-decoration {
  width: 250px;
  height: 4px;
  background: linear-gradient(90deg, transparent, var(--pink), transparent);
}

/* ========== SCREEN 2: CAPTAINS ========== */
#captain-screen { gap: 30px; padding: 20px; }

.captains-container {
  display: flex;
  align-items: center;
  gap: 35px;
  flex-wrap: wrap;
  justify-content: center;
}

.captain-card {
  background: var(--card-bg);
  border: 3px solid var(--card-border);
  padding: 35px;
  width: 320px;
  text-align: center;
}

.captain-card.rizik { border-color: var(--teal); box-shadow: 0 0 25px rgba(0,255,204,0.15); }
.captain-card.errichetti { border-color: var(--pink); box-shadow: 0 0 25px rgba(255,45,155,0.15); }

.captain-card img {
  width: 160px;
  height: 160px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid var(--card-border);
  margin-bottom: 18px;
}

.captain-card.rizik img { border-color: var(--teal); }
.captain-card.errichetti img { border-color: var(--pink); }

.captain-name {
  font-size: 1.7rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 6px;
}

.captain-card.rizik .captain-name { color: var(--teal); }
.captain-card.errichetti .captain-name { color: var(--pink); }

.captain-detail {
  font-size: 1rem;
  color: var(--text-dim);
  margin-bottom: 5px;
}

.captain-handicap {
  font-size: 2.8rem;
  font-weight: 900;
  margin: 12px 0;
}

.captain-card.rizik .captain-handicap { color: var(--teal); }
.captain-card.errichetti .captain-handicap { color: var(--pink); }

.vs-badge {
  font-size: clamp(2.5rem, 6vw, 4.5rem);
  font-weight: 900;
  color: var(--gold);
  text-shadow: 0 0 40px var(--gold-glow), 0 0 80px rgba(255,45,155,0.3);
  letter-spacing: 0.1em;
}

/* ========== SCREEN 3: DRAFT BOARD ========== */
#draft-screen { justify-content: flex-start; padding: 15px; min-height: 100vh; }

.draft-header {
  width: 100%;
  text-align: center;
  padding: 15px 0;
  margin-bottom: 10px;
}

.pick-info {
  font-size: clamp(1.2rem, 3vw, 1.7rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  margin-bottom: 5px;
}

@keyframes flash {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}

.on-the-clock {
  font-size: clamp(1.8rem, 5vw, 2.8rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  animation: flash 1s ease-in-out infinite;
}

.on-the-clock.rizik { color: var(--teal); text-shadow: 0 0 25px var(--teal-glow); }
.on-the-clock.errichetti { color: var(--pink); text-shadow: 0 0 25px var(--pink-glow); }

/* ========== TIMER ========== */
.timer-container {
  margin-top: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.timer-display {
  font-size: clamp(2rem, 5vw, 3rem);
  font-weight: 900;
  font-variant-numeric: tabular-nums;
  letter-spacing: 0.05em;
  color: var(--gold);
  text-shadow: 0 0 15px var(--gold-glow);
}

.timer-display.warning { color: var(--red); text-shadow: 0 0 20px rgba(255,51,102,0.7); animation: flash 0.5s ease-in-out infinite; }

.timer-bar {
  width: 300px;
  max-width: 60vw;
  height: 8px;
  background: rgba(255,255,255,0.08);
  border-radius: 4px;
  overflow: hidden;
  margin-top: 5px;
}

.timer-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--teal), var(--gold));
  border-radius: 4px;
  transition: width 1s linear;
}

.timer-bar-fill.warning { background: linear-gradient(90deg, var(--red), var(--pink)); }

.draft-body {
  display: flex;
  width: 100%;
  gap: 15px;
  flex: 1;
  max-width: 1500px;
}

.team-roster {
  width: 230px;
  flex-shrink: 0;
  background: var(--card-bg);
  border: 2px solid var(--card-border);
  padding: 15px;
}

.team-roster h3 {
  font-size: 1.1rem;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  font-weight: 900;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--card-border);
}

.team-roster.rizik { border-color: rgba(0,255,204,0.3); }
.team-roster.rizik h3 { color: var(--teal); border-color: rgba(0,255,204,0.3); }
.team-roster.errichetti { border-color: rgba(255,45,155,0.3); }
.team-roster.errichetti h3 { color: var(--pink); border-color: rgba(255,45,155,0.3); }

.roster-slot {
  padding: 10px;
  margin-bottom: 6px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.05);
  font-size: 0.9rem;
  min-height: 44px;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s;
}

.roster-slot.filled { border-color: rgba(255,255,255,0.1); }
.roster-slot .slot-number { color: var(--text-dim); font-weight: 700; font-size: 0.8rem; }
.roster-slot .slot-name { font-weight: 700; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.05em; }
.roster-slot .slot-hcp { color: var(--text-dim); font-size: 0.8rem; margin-left: auto; }

.player-pool {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 14px;
  align-content: start;
}

/* ========== PLAYER CARDS (pool) ========== */
.player-card {
  background: var(--card-bg);
  border: 2px solid var(--card-border);
  padding: 18px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.player-card:hover {
  border-color: var(--gold);
  transform: translateY(-4px);
  box-shadow: 0 10px 30px rgba(255,215,0,0.2);
}

.player-card.drafted {
  opacity: 0.15;
  pointer-events: none;
  transform: scale(0.95);
}

.player-card-inner {
  display: flex;
  gap: 15px;
  align-items: center;
}

.player-card img {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--card-border);
  flex-shrink: 0;
}

.player-card-info { flex: 1; min-width: 0; }

.player-card-name {
  font-weight: 900;
  font-size: 1.05rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.player-card-meta {
  font-size: 0.85rem;
  color: var(--text-dim);
  margin-bottom: 3px;
}

.player-card-handicap {
  font-weight: 900;
  font-size: 1.4rem;
  color: var(--gold);
}

.player-card-strength {
  font-size: 0.8rem;
  color: var(--teal);
  margin-top: 6px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ========== DRAFT MODAL ========== */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.88);
  z-index: 100;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.modal-overlay.active { display: flex; }

.modal {
  background: var(--card-bg);
  border: 3px solid var(--gold);
  max-width: 550px;
  width: 100%;
  padding: 35px;
  position: relative;
  box-shadow: 0 0 80px rgba(255,215,0,0.2);
}

.modal-close {
  position: absolute;
  top: 12px;
  right: 18px;
  background: none;
  border: none;
  color: var(--text-dim);
  font-size: 1.8rem;
  cursor: pointer;
}

.modal-close:hover { color: var(--text); }

.modal-player-header {
  display: flex;
  gap: 20px;
  align-items: center;
  margin-bottom: 22px;
}

.modal-player-header img {
  width: 110px;
  height: 110px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid var(--gold);
}

.modal-player-name {
  font-size: 1.8rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.modal-player-detail {
  color: var(--text-dim);
  font-size: 1rem;
  margin-top: 4px;
}

.modal-stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  margin-bottom: 22px;
}

.modal-stat-box {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  padding: 14px;
}

.modal-stat-label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  color: var(--text-dim);
  margin-bottom: 6px;
}

.modal-stat-value {
  font-size: 1.05rem;
  font-weight: 700;
}

.modal-stat-value.strength { color: var(--teal); }
.modal-stat-value.weakness { color: var(--red); }
.modal-stat-value.funfact { color: var(--gold); }

.modal-handicap-big {
  font-size: 3.5rem;
  font-weight: 900;
  color: var(--gold);
  text-shadow: 0 0 25px var(--gold-glow);
}

.modal-buttons {
  display: flex;
  gap: 14px;
  margin-top: 22px;
}

.modal-buttons .btn { flex: 1; padding: 16px 22px; font-size: 1.1rem; }

/* ========== DRAFTED FLASH ========== */
@keyframes draftFlash {
  0% { opacity: 0; transform: scale(0.5); }
  20% { opacity: 1; transform: scale(1.1); }
  40% { transform: scale(1); }
  100% { opacity: 0; transform: scale(1.2) translateY(-20px); }
}

.draft-flash {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 200;
  background: rgba(0,0,0,0.92);
  flex-direction: column;
  gap: 18px;
}

.draft-flash.active {
  display: flex;
  animation: draftFlash 2s ease-out forwards;
}

.draft-flash-name {
  font-size: clamp(2.5rem, 7vw, 5rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.15em;
}

.draft-flash-team {
  font-size: clamp(1.3rem, 4vw, 2rem);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.2em;
}

.draft-flash-label {
  font-size: clamp(2rem, 5vw, 3.5rem);
  font-weight: 900;
  color: var(--gold);
  text-shadow: 0 0 40px var(--gold-glow);
  letter-spacing: 0.3em;
}

/* ========== THE PICK IS IN ========== */
.pick-is-in-overlay {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 250;
  background: rgba(0,0,0,0.95);
  flex-direction: column;
  gap: 20px;
}

.pick-is-in-overlay.active {
  display: flex;
  animation: pickIsInEntry 0.6s ease-out forwards;
}

.pick-is-in-team {
  font-size: clamp(1.2rem, 3.5vw, 2rem);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.25em;
  opacity: 0;
  animation: fadeSlideUp 0.5s ease-out 0.3s forwards;
}

.pick-is-in-text {
  font-size: clamp(3rem, 10vw, 7rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--gold);
  text-shadow:
    0 0 40px var(--gold-glow),
    0 0 80px var(--gold-glow),
    0 0 120px rgba(255,215,0,0.3);
  animation: pickTextPulse 1.5s ease-in-out infinite;
}

.pick-is-in-bar {
  width: clamp(200px, 60vw, 500px);
  height: 4px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  animation: shimmerBar 1.2s ease-in-out infinite;
}

@keyframes pickIsInEntry {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes fadeSlideUp {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes pickTextPulse {
  0%, 100% { transform: scale(1); filter: brightness(1); }
  50% { transform: scale(1.03); filter: brightness(1.3); }
}

@keyframes shimmerBar {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

/* ========== TIMEOUT FLASH ========== */
.timeout-flash {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 200;
  background: rgba(0,0,0,0.92);
  flex-direction: column;
  gap: 18px;
}

.timeout-flash.active { display: flex; }

.timeout-flash-text {
  font-size: clamp(2rem, 6vw, 4rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--red);
  text-shadow: 0 0 30px rgba(255,51,102,0.7);
  animation: flash 0.4s ease-in-out infinite;
}

.timeout-flash-sub {
  font-size: clamp(1rem, 3vw, 1.5rem);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  color: var(--text-dim);
}

/* ========== SCREEN 4: RESULTS ========== */
#results-screen {
  justify-content: flex-start;
  padding: 25px;
  gap: 35px;
}

.results-title {
  font-size: clamp(2.5rem, 6vw, 4.5rem);
  text-align: center;
  margin-top: 25px;
}

.results-container {
  display: flex;
  gap: 30px;
  width: 100%;
  max-width: 1300px;
  flex-wrap: wrap;
  justify-content: center;
}

.results-team {
  flex: 1;
  min-width: 340px;
  max-width: 600px;
  background: var(--card-bg);
  border: 3px solid var(--card-border);
  padding: 28px;
}

.results-team.rizik { border-color: rgba(0,255,204,0.4); }
.results-team.errichetti { border-color: rgba(255,45,155,0.4); }

.results-team-name {
  font-size: 1.7rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  margin-bottom: 22px;
  padding-bottom: 12px;
  border-bottom: 3px solid var(--card-border);
}

.results-team.rizik .results-team-name { color: var(--teal); border-color: rgba(0,255,204,0.3); }
.results-team.errichetti .results-team-name { color: var(--pink); border-color: rgba(255,45,155,0.3); }

.results-player {
  display: flex;
  gap: 14px;
  align-items: center;
  padding: 12px;
  margin-bottom: 10px;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.05);
}

.results-player img {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--card-border);
}

.results-player-info { flex: 1; }
.results-player-name { font-weight: 900; font-size: 1.05rem; text-transform: uppercase; letter-spacing: 0.05em; }
.results-player-meta { font-size: 0.85rem; color: var(--text-dim); }
.results-player-hcp { font-weight: 900; font-size: 1.4rem; color: var(--gold); }

/* ========== TEAM RATINGS ========== */
.ratings-section {
  width: 100%;
  max-width: 1300px;
}

.ratings-title {
  font-size: 2.2rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  text-align: center;
  margin-bottom: 28px;
  color: var(--gold);
  text-shadow: 0 0 25px var(--gold-glow);
}

.ratings-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 22px;
}

@media (max-width: 700px) { .ratings-grid { grid-template-columns: 1fr; } }

.rating-card {
  background: var(--card-bg);
  border: 2px solid var(--card-border);
  padding: 22px;
}

.rating-card-title {
  font-size: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--text-dim);
  margin-bottom: 18px;
  font-weight: 700;
}

.rating-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.rating-label {
  font-weight: 700;
  font-size: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  width: 150px;
}

.rating-bar-track {
  flex: 1;
  height: 22px;
  background: rgba(255,255,255,0.05);
  margin: 0 14px;
  position: relative;
  overflow: hidden;
  border-radius: 3px;
}

.rating-bar-fill {
  height: 100%;
  transition: width 1s ease-out;
  position: relative;
  border-radius: 3px;
}

.rating-bar-fill::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.2) 50%, transparent 100%);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.rating-value {
  font-weight: 900;
  font-size: 1.1rem;
  width: 35px;
  text-align: right;
}

.rating-bar-fill.teal { background: linear-gradient(90deg, var(--teal), rgba(0,255,204,0.5)); }
.rating-bar-fill.pink { background: linear-gradient(90deg, var(--pink), rgba(255,45,155,0.5)); }

/* ========== SUPERLATIVES ========== */
.superlatives {
  width: 100%;
  max-width: 1300px;
  margin-bottom: 40px;
}

.superlatives-title {
  font-size: 2rem;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  text-align: center;
  margin-bottom: 22px;
  color: var(--pink);
  text-shadow: 0 0 20px var(--pink-glow);
}

.superlative-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  margin-bottom: 8px;
  background: var(--card-bg);
  border: 1px solid var(--card-border);
}

.superlative-label {
  font-size: 0.95rem;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.superlative-winner {
  font-weight: 900;
  font-size: 1.1rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gold);
}

/* ========== RESPONSIVE ========== */

/* Tablet / small desktop */
@media (max-width: 900px) {
  .draft-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    grid-template-areas:
      "roster-left roster-right"
      "pool pool";
    gap: 10px;
  }
  .team-roster.rizik { grid-area: roster-left; }
  .team-roster.errichetti { grid-area: roster-right; }
  .player-pool { grid-area: pool; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }

  .team-roster { width: 100%; padding: 10px; }
  .team-roster h3 { font-size: 0.9rem; margin-bottom: 8px; }
  .roster-slot { padding: 7px 8px; margin-bottom: 4px; min-height: 36px; font-size: 0.8rem; }
  .roster-slot .slot-name { font-size: 0.8rem; }
  .roster-slot .slot-hcp { font-size: 0.75rem; }
}

/* Phone */
@media (max-width: 600px) {
  html { font-size: 15px; }

  /* Title screen */
  #title-screen { gap: 25px; padding: 15px; }
  .main-title { font-size: clamp(2.2rem, 10vw, 3.5rem); }
  .btn { padding: 14px 30px; font-size: 1rem; letter-spacing: 0.1em; }

  /* Captain screen */
  #captain-screen { gap: 15px; padding: 10px; }
  .captains-container { gap: 15px; }
  .captain-card { padding: 18px; width: 100%; max-width: 280px; }
  .captain-card img { width: 90px; height: 90px; margin-bottom: 10px; }
  .captain-name { font-size: 1.2rem; }
  .captain-handicap { font-size: 2rem; margin: 6px 0; }
  .captain-detail { font-size: 0.85rem; }
  .vs-badge { font-size: 2rem; }

  /* Draft screen header */
  #draft-screen { padding: 8px; }
  .draft-header { padding: 8px 0; margin-bottom: 5px; }
  .pick-info { font-size: 0.9rem; letter-spacing: 0.1em; margin-bottom: 2px; }
  .on-the-clock { font-size: clamp(1rem, 4.5vw, 1.5rem); }
  .timer-display { font-size: 1.6rem; }
  .timer-bar { width: 200px; height: 6px; }

  /* Draft rosters - compact side by side */
  .draft-body { gap: 6px; }
  .team-roster { padding: 6px; border-width: 1px; }
  .team-roster h3 { font-size: 0.7rem; margin-bottom: 5px; padding-bottom: 4px; letter-spacing: 0.1em; }
  .roster-slot { padding: 4px 5px; margin-bottom: 2px; min-height: 28px; gap: 4px; }
  .roster-slot .slot-number { font-size: 0.65rem; }
  .roster-slot .slot-name { font-size: 0.68rem; letter-spacing: 0; }
  .roster-slot .slot-hcp { font-size: 0.65rem; }

  /* Player cards - compact */
  .player-pool { grid-template-columns: 1fr 1fr; gap: 6px; }
  .player-card { padding: 10px; border-width: 1px; }
  .player-card-inner { gap: 8px; flex-direction: column; text-align: center; }
  .player-card img { width: 50px; height: 50px; border-width: 2px; }
  .player-card-name { font-size: 0.75rem; white-space: normal; }
  .player-card-meta { font-size: 0.7rem; }
  .player-card-handicap { font-size: 1.1rem; }
  .player-card-strength { font-size: 0.65rem; margin-top: 3px; }

  /* Modal */
  .modal { padding: 18px; }
  .modal-player-header { gap: 12px; margin-bottom: 14px; }
  .modal-player-header img { width: 70px; height: 70px; border-width: 3px; }
  .modal-player-name { font-size: 1.2rem; }
  .modal-player-detail { font-size: 0.85rem; }
  .modal-handicap-big { font-size: 2.5rem; }
  .modal-stats { gap: 8px; margin-bottom: 14px; }
  .modal-stat-box { padding: 10px; }
  .modal-stat-label { font-size: 0.65rem; margin-bottom: 4px; }
  .modal-stat-value { font-size: 0.9rem; }
  .modal-buttons { gap: 8px; margin-top: 14px; }
  .modal-buttons .btn { padding: 12px 14px; font-size: 0.85rem; }

  /* Results */
  .results-title { font-size: clamp(1.8rem, 7vw, 2.5rem); margin-top: 15px; }
  .results-container { gap: 15px; }
  .results-team { min-width: 0; width: 100%; padding: 15px; }
  .results-team-name { font-size: 1.2rem; margin-bottom: 12px; padding-bottom: 8px; }
  .results-player { padding: 8px; gap: 10px; }
  .results-player img { width: 40px; height: 40px; }
  .results-player-name { font-size: 0.85rem; }
  .results-player-meta { font-size: 0.7rem; }
  .results-player-hcp { font-size: 1.1rem; }

  /* Ratings */
  .ratings-title { font-size: 1.4rem; margin-bottom: 18px; }
  .rating-card { padding: 14px; }
  .rating-card-title { font-size: 0.85rem; margin-bottom: 12px; }
  .rating-label { font-size: 0.8rem; width: 90px; }
  .rating-bar-track { height: 16px; margin: 0 8px; }
  .rating-value { font-size: 0.9rem; }

  /* Superlatives */
  .superlatives-title { font-size: 1.3rem; margin-bottom: 14px; }
  .superlative-item { padding: 10px 14px; flex-direction: column; align-items: flex-start; gap: 4px; }
  .superlative-label { font-size: 0.75rem; }
  .superlative-winner { font-size: 0.9rem; }

  /* Flash overlays */
  .draft-flash-name { font-size: clamp(1.5rem, 6vw, 2.5rem); }
  .draft-flash-team { font-size: clamp(1rem, 3.5vw, 1.5rem); }
  .draft-flash-label { font-size: clamp(1.3rem, 4vw, 2rem); }
  .pick-is-in-text { font-size: clamp(2rem, 8vw, 4rem); }
  .pick-is-in-team { font-size: clamp(1rem, 3vw, 1.5rem); }
}

/* Very small phones */
@media (max-width: 380px) {
  .player-pool { grid-template-columns: 1fr; }
  .player-card-inner { flex-direction: row; text-align: left; }
  .modal-stats { grid-template-columns: 1fr; }
  .modal-stat-box[style*="grid-column"] { grid-column: span 1 !important; }
  .captain-card { max-width: 100%; }
}
</style>
</head>
<body>

<!-- ==================== SCREEN 1: TITLE ==================== -->
<div id="title-screen" class="screen active">
  <div class="subtitle arcade-text">Winter 2026</div>
  <div class="title-decoration"></div>
  <h1 class="main-title arcade-text fire-text">RCI Golf<br>Draft</h1>
  <div class="title-decoration"></div>
  <div class="subtitle arcade-text" style="margin-top:-10px">12 Players &bull; 2 Captains &bull; 1 Trophy</div>
  <button class="btn pulse" onclick="showScreen('captain-screen')" style="margin-top:20px">Press Start</button>
</div>

<!-- ==================== SCREEN 2: CAPTAINS ==================== -->
<div id="captain-screen" class="screen">
  <h2 class="arcade-text" style="font-size:clamp(1.3rem,3.5vw,2rem); color:var(--text-dim); letter-spacing:0.3em; margin-bottom:10px;">Captain Select</h2>
  <div class="captains-container">
    <div class="captain-card rizik">
      <img src="rizik.png" alt="Rizik">
      <div class="captain-name">Team Rizik</div>
      <div class="captain-detail">Alex Rizik</div>
      <div class="captain-detail">Austin, TX &bull; NU (Go 'Cats!)</div>
      <div class="captain-handicap">17</div>
      <div class="captain-detail" style="color:var(--teal); font-size:1.05rem;">The "Closer" (He lives for the pressure cooker)</div>
      <div class="captain-detail" style="margin-top:8px; font-style:italic; color:var(--gold); font-size:1.05rem;">"The Rules Czar"</div>
    </div>

    <div class="vs-badge arcade-text">VS</div>

    <div class="captain-card errichetti">
      <img src="Richetti.png" alt="Errichetti">
      <div class="captain-name">Team Errichetti</div>
      <div class="captain-detail">Michael Errichetti</div>
      <div class="captain-detail">New York, NY &bull; NU (Go 'Cats!)</div>
      <div class="captain-handicap">9</div>
      <div class="captain-detail" style="color:var(--pink); font-size:1.05rem;">TOP DAWG. The scratch golfer in a sea of hacks.</div>
      <div class="captain-detail" style="margin-top:8px; font-style:italic; color:var(--gold); font-size:1.05rem;">"Will the ankle hold up?"</div>
    </div>
  </div>

  <div style="margin-top:12px; text-align:center;">
    <div class="arcade-text" style="font-size:0.9rem; color:var(--text-dim); letter-spacing:0.2em; margin-bottom:10px;">Draft Order: Snake Format</div>
    <div id="draft-order-desc" style="font-size:1rem; color:var(--text-dim);"></div>
  </div>

  <div style="margin-top:22px; text-align:center;">
    <div class="arcade-text" style="font-size:1.1rem; color:var(--teal); letter-spacing:0.15em; margin-bottom:18px;">Rizik has first choice</div>
    <div style="display:flex; gap:18px; justify-content:center; flex-wrap:wrap;">
      <button class="btn btn-teal" onclick="chooseDraftOrder('pick')">Pick First</button>
      <button class="btn" onclick="chooseDraftOrder('defer')">Defer to 2nd</button>
    </div>
  </div>
</div>

<!-- ==================== SCREEN 3: DRAFT BOARD ==================== -->
<div id="draft-screen" class="screen">
  <div class="draft-header">
    <div class="pick-info" id="pick-info">Pick 1 of 10</div>
    <div class="on-the-clock rizik" id="on-the-clock">Team Rizik is on the clock</div>
    <div class="timer-container">
      <div class="timer-display" id="timer-display">1:00</div>
    </div>
    <div class="timer-bar"><div class="timer-bar-fill" id="timer-bar-fill" style="width:100%"></div></div>
  </div>
  <div class="draft-body">
    <div class="team-roster rizik">
      <h3>Team Rizik</h3>
      <div id="rizik-roster"></div>
    </div>
    <div class="player-pool" id="player-pool"></div>
    <div class="team-roster errichetti">
      <h3>Team Errichetti</h3>
      <div id="errichetti-roster"></div>
    </div>
  </div>
</div>

<!-- ==================== DRAFT MODAL ==================== -->
<div class="modal-overlay" id="draft-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">&times;</button>
    <div class="modal-player-header">
      <img src="placeholder.png" alt="" id="modal-photo">
      <div>
        <div class="modal-player-name" id="modal-name"></div>
        <div class="modal-player-detail" id="modal-detail"></div>
      </div>
    </div>
    <div style="text-align:center; margin-bottom:18px;">
      <div style="font-size:0.8rem; text-transform:uppercase; letter-spacing:0.2em; color:var(--text-dim);">Handicap</div>
      <div class="modal-handicap-big" id="modal-handicap"></div>
    </div>
    <div class="modal-stats">
      <div class="modal-stat-box">
        <div class="modal-stat-label">Strength</div>
        <div class="modal-stat-value strength" id="modal-strength"></div>
      </div>
      <div class="modal-stat-box">
        <div class="modal-stat-label">Weakness</div>
        <div class="modal-stat-value weakness" id="modal-weakness"></div>
      </div>
      <div class="modal-stat-box" style="grid-column: span 2;">
        <div class="modal-stat-label">Fun Fact</div>
        <div class="modal-stat-value funfact" id="modal-funfact"></div>
      </div>
    </div>
    <div class="modal-buttons">
      <button class="btn" onclick="closeModal()">Back</button>
      <button class="btn btn-teal" id="modal-draft-btn" onclick="confirmDraft()">Draft Player</button>
    </div>
  </div>
</div>

<!-- ==================== THE PICK IS IN ==================== -->
<div class="pick-is-in-overlay" id="pick-is-in">
  <div class="pick-is-in-team" id="pick-is-in-team"></div>
  <div class="pick-is-in-text arcade-text">THE PICK IS IN</div>
  <div class="pick-is-in-bar"></div>
</div>

<!-- ==================== DRAFT FLASH ==================== -->
<div class="draft-flash" id="draft-flash">
  <div class="draft-flash-label arcade-text">Drafted!</div>
  <div class="draft-flash-name fire-text arcade-text" id="flash-name"></div>
  <div class="draft-flash-team arcade-text" id="flash-team"></div>
</div>

<!-- ==================== TIMEOUT FLASH ==================== -->
<div class="timeout-flash" id="timeout-flash">
  <div class="timeout-flash-text arcade-text">Time's Up!</div>
  <div class="timeout-flash-sub" id="timeout-team"></div>
  <div class="timeout-flash-sub">Pick moves to end of draft</div>
</div>

<!-- ==================== SCREEN 4: RESULTS ==================== -->
<div id="results-screen" class="screen">
  <h2 class="results-title arcade-text fire-text">Draft Complete</h2>
  <div class="results-container" id="results-teams"></div>
  <div class="ratings-section" id="ratings-section"></div>
  <div class="superlatives" id="superlatives"></div>
  <button class="btn" onclick="resetDraft()" style="margin-bottom:40px;">Run It Back</button>
</div>

<script>
// ==================== PLAYER DATA ====================
const PLAYERS = [
  { name: "Henry Emerson", hometown: "Santa Fe, NM", college: "The School of Hard Knocks", handicap: 12, strength: "ABSOLUTE BOMBS (Send It!)", weakness: 'He\'s got a case of the "Where the f*ck did that one go?"', funfact: "Do not be alarmed if you see him lying on the fairway after a swing", photo: "Henry.png" },
  { name: "Matt Appleby", hometown: "Brooklyn, NY", college: "BC (Go Eagles!)", handicap: 23, strength: "Fairway Finder, Clutch Iron Play", weakness: "Meltdown potential is high (He needs a chill pill... or a double).", funfact: "Guaranteed to redeem himself during the post-game Relay.", photo: "Matt.png" },
  { name: "Sammy Appleby", hometown: "Brooklyn, NY", college: "Maret 'til I die", handicap: 14, strength: "Reads greens like a local (Former Caddy, trusts the line 100%)", weakness: "Pre-round Fireball consumption is a major liability.", funfact: "Already got the post-round herbal remedy rolled up. Respect.", photo: "Sammy.png" },
  { name: "John Grandy", hometown: "Washington, DC", college: "BYU", handicap: 23, strength: "Wizard out of the Beach", weakness: 'His "Commitment" is more questionable than a 7 AM tee time after a bachelor party.', funfact: 'Rafa Nadal\'s biggest fan. Probably yells "Vamos!" after a good bogey.', photo: "Grandy.png" },
  { name: "Wiley Marstellar", hometown: "Charlotte, NC", college: "Elon University", handicap: 17, strength: 'The "Side Saddle" (He sees the line, he trusts the line)', weakness: 'Also has a hair-trigger temper (Needs a $5 "Bad Shot" jar).', funfact: "The Captain for the Beer Olympics squad... if he wakes up.", photo: "Wiley.png" },
  { name: "Scott Ballen", hometown: "Brooklyn, NY", college: "NU (Go 'Cats!)", handicap: 21, strength: 'The "Power Slice" (It\'s intentional, okay?!)', weakness: "The Yips are real. It's like his putter is fighting him.", funfact: "Undefeated in the Winter RCI Match Play. Don't let the handicap fool you.", photo: "Ballen.png" },
  { name: "Grey Korhonen", hometown: "Brooklyn, NY", college: "NU (Go 'Cats!)", handicap: 13, strength: 'The "Silkiest Swing" (He looks good doing it)', weakness: "Forgets to hit the ball because he's too deep in a story about that time in Miami.", funfact: 'The Host with the Most: Definitely wrote the "House Rules" for his own benefit.', photo: "Grey.png" },
  { name: "Hadi Khalil", hometown: "Washington, DC", college: "The UMD (Terps!)", handicap: 20, strength: 'The "Short Game Surgeon" (He gets up and down from the parking lot)', weakness: 'The driver is strictly "For Exhibition Only" (It\'s a prayer every time).', funfact: "The Beesh. Enough said. You know what you're getting.", photo: "Hadi.png" },
  { name: "Mike Goodman", hometown: "New York, NY", college: "NU (Go 'Cats!)", handicap: 14, strength: "Vertical Launch System (He can land a ball on a dime from 200 yards)", weakness: "His only weakness is playing on Sunday morning against Errichetti.", funfact: "Has a high probability of finding the 'K-Hole' by the turn.", photo: "Goodman.jpg" },
  { name: "Austin Appel", hometown: "San Francisco, CA", college: "NU (Go 'Cats!)", handicap: 17, strength: 'Pure "Dad Strength" (He hits it solid, no flash)', weakness: 'Prone to needing a "Whiskey-Punt" to calm the nerves.', funfact: "Still trying to recapture the magic from that one time he crushed the Captain's Course.", photo: "Austin" },
];

const CAPTAINS = {
  rizik: { name: "Alex Rizik", hometown: "Austin, TX", college: "NU (Go 'Cats!)", handicap: 17, strength: 'The "Closer" (He lives for the pressure cooker)', weakness: 'The "Big Dog" (Driver) can get loose on the highway (Duck!).', funfact: "The Rules Czar: Is he enforcing the rules, or just stacking the deck for himself?", photo: "rizik.png" },
  errichetti: { name: "Michael Errichetti", hometown: "New York, NY", college: "NU (Go 'Cats!)", handicap: 9, strength: "TOP DAWG. The scratch golfer in a sea of hacks.", weakness: 'Tends to get "Mysteriously Injured" or "Too Hungover" to play when the stakes are high.', funfact: "The question isn't if he'll win, but will the ankle hold up?", photo: "Richetti.png" },
};

// Snake draft order - set dynamically based on Rizik's choice
let DRAFT_ORDER = [];

// ==================== STATE ====================
let currentPick = 0;
let selectedPlayer = null;
const teams = { rizik: [], errichetti: [] };
let timerInterval = null;
let timeLeft = 60;
let draftPaused = false; // true during flash animations
const pendingPicks = []; // { team: 'rizik'|'errichetti' } - timed-out picks appended to end

// ==================== AUDIO ENGINE (Web Audio API) ====================
let audioCtx = null;
let draftMusicNodes = null; // { oscillators, gains, lfo } for the suspense loop
let musicStarted = false;

function getAudioCtx() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === 'suspended') audioCtx.resume();
  return audioCtx;
}

// NFL-style suspense drone: low rumble + pulsing pad
function startDraftMusic() {
  if (musicStarted) return;
  const ctx = getAudioCtx();
  musicStarted = true;

  const masterGain = ctx.createGain();
  masterGain.gain.value = 0;
  masterGain.connect(ctx.destination);

  // Fade in
  masterGain.gain.linearRampToValueAtTime(0.18, ctx.currentTime + 1.5);

  // Sub bass drone (deep rumble)
  const sub = ctx.createOscillator();
  sub.type = 'sine';
  sub.frequency.value = 55; // A1
  const subGain = ctx.createGain();
  subGain.gain.value = 0.6;
  sub.connect(subGain);
  subGain.connect(masterGain);
  sub.start();

  // Tension pad - fifth interval
  const pad1 = ctx.createOscillator();
  pad1.type = 'triangle';
  pad1.frequency.value = 110; // A2
  const pad1Gain = ctx.createGain();
  pad1Gain.gain.value = 0.25;
  pad1.connect(pad1Gain);
  pad1Gain.connect(masterGain);
  pad1.start();

  const pad2 = ctx.createOscillator();
  pad2.type = 'triangle';
  pad2.frequency.value = 164.81; // E3 - tension fifth
  const pad2Gain = ctx.createGain();
  pad2Gain.gain.value = 0.15;
  pad2.connect(pad2Gain);
  pad2Gain.connect(masterGain);
  pad2.start();

  // LFO for pulsing effect (heartbeat-like)
  const lfo = ctx.createOscillator();
  lfo.type = 'sine';
  lfo.frequency.value = 1.2; // pulse rate
  const lfoGain = ctx.createGain();
  lfoGain.gain.value = 0.08;
  lfo.connect(lfoGain);
  lfoGain.connect(masterGain.gain);
  lfo.start();

  // Higher tension note - minor second for suspense
  const tension = ctx.createOscillator();
  tension.type = 'sawtooth';
  tension.frequency.value = 116.54; // Bb2 - dissonant
  const tensionGain = ctx.createGain();
  tensionGain.gain.value = 0.04;
  const tensionFilter = ctx.createBiquadFilter();
  tensionFilter.type = 'lowpass';
  tensionFilter.frequency.value = 400;
  tension.connect(tensionFilter);
  tensionFilter.connect(tensionGain);
  tensionGain.connect(masterGain);
  tension.start();

  draftMusicNodes = {
    oscillators: [sub, pad1, pad2, tension, lfo],
    gains: [subGain, pad1Gain, pad2Gain, tensionGain, lfoGain],
    master: masterGain,
    filter: tensionFilter,
    ctx: ctx
  };
}

function stopDraftMusic() {
  if (!draftMusicNodes) return;
  const ctx = draftMusicNodes.ctx;
  const master = draftMusicNodes.master;

  // Quick fade out
  master.gain.cancelScheduledValues(ctx.currentTime);
  master.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.3);

  setTimeout(() => {
    draftMusicNodes.oscillators.forEach(o => { try { o.stop(); } catch(e) {} });
    draftMusicNodes = null;
    musicStarted = false;
  }, 400);
}

// ESPN NFL Draft Chime - the iconic ascending bell sequence
function playPickIsInFanfare() {
  const ctx = getAudioCtx();

  // Convolver for reverb tail
  const convolver = ctx.createConvolver();
  const reverbLen = ctx.sampleRate * 2;
  const reverbBuf = ctx.createBuffer(2, reverbLen, ctx.sampleRate);
  for (let ch = 0; ch < 2; ch++) {
    const data = reverbBuf.getChannelData(ch);
    for (let i = 0; i < reverbLen; i++) {
      data[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / reverbLen, 2.5);
    }
  }
  convolver.buffer = reverbBuf;

  const dryGain = ctx.createGain();
  dryGain.gain.value = 0.35;
  const wetGain = ctx.createGain();
  wetGain.gain.value = 0.18;
  convolver.connect(wetGain);
  wetGain.connect(ctx.destination);
  dryGain.connect(ctx.destination);

  // The chime: 4 ascending bell tones
  // Bb4 -> C5 -> D5 -> F5 (Bb major pentatonic feel)
  const chimeNotes = [
    { freq: 466.16, time: 0,    dur: 0.35 },  // Bb4
    { freq: 523.25, time: 0.18, dur: 0.35 },  // C5
    { freq: 587.33, time: 0.36, dur: 0.35 },  // D5
    { freq: 698.46, time: 0.54, dur: 1.8  },  // F5 - held long
  ];

  // Play a bell tone: fundamental + harmonics for that celesta/glockenspiel shimmer
  function playBellTone(freq, startTime, duration, volume) {
    const partials = [
      { ratio: 1,    amp: 1.0  },  // fundamental
      { ratio: 2,    amp: 0.6  },  // octave
      { ratio: 3,    amp: 0.25 },  // 12th
      { ratio: 4.07, amp: 0.18 },  // slightly detuned double octave (bell inharmonicity)
      { ratio: 5.4,  amp: 0.08 },  // higher partial
    ];

    partials.forEach(p => {
      const osc = ctx.createOscillator();
      osc.type = 'sine';
      osc.frequency.value = freq * p.ratio;

      const g = ctx.createGain();
      const t = ctx.currentTime + startTime;
      g.gain.setValueAtTime(0, t);
      // Sharp attack
      g.gain.linearRampToValueAtTime(volume * p.amp, t + 0.008);
      // Quick initial decay (bell-like)
      g.gain.exponentialRampToValueAtTime(
        Math.max(volume * p.amp * 0.35, 0.001),
        t + 0.12
      );
      // Longer sustain/ring
      g.gain.exponentialRampToValueAtTime(0.001, t + duration);

      osc.connect(g);
      g.connect(dryGain);
      g.connect(convolver);
      osc.start(t);
      osc.stop(t + duration + 0.1);
    });
  }

  chimeNotes.forEach((note, i) => {
    const vol = i === chimeNotes.length - 1 ? 0.5 : 0.4;
    playBellTone(note.freq, note.time, note.dur, vol);
  });

  // Subtle low octave doubling on the final note for weight
  playBellTone(349.23, 0.54, 2.0, 0.15); // F4 underneath
}

// Countdown beep for last 10 seconds
function playCountdownBeep(urgent) {
  const ctx = getAudioCtx();
  const osc = ctx.createOscillator();
  osc.type = 'sine';
  osc.frequency.value = urgent ? 880 : 660;
  const g = ctx.createGain();
  g.gain.value = 0;
  g.gain.linearRampToValueAtTime(urgent ? 0.15 : 0.08, ctx.currentTime + 0.02);
  g.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.12);
  osc.connect(g);
  g.connect(ctx.destination);
  osc.start(ctx.currentTime);
  osc.stop(ctx.currentTime + 0.15);
}

// Timeout buzzer
function playTimeoutBuzzer() {
  const ctx = getAudioCtx();
  const osc = ctx.createOscillator();
  osc.type = 'square';
  osc.frequency.value = 150;
  const g = ctx.createGain();
  g.gain.value = 0;
  g.gain.linearRampToValueAtTime(0.2, ctx.currentTime + 0.05);
  g.gain.linearRampToValueAtTime(0.2, ctx.currentTime + 0.6);
  g.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.8);
  osc.connect(g);
  g.connect(ctx.destination);
  osc.start(ctx.currentTime);
  osc.stop(ctx.currentTime + 1);
}

// ==================== SCREEN MANAGEMENT ====================
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ==================== DRAFT ORDER CHOICE ====================
function buildSnakeOrder(first, second) {
  return [first, second, second, first, first, second, second, first, first, second];
}

function updateDraftOrderDesc() {
  const desc = document.getElementById('draft-order-desc');
  if (DRAFT_ORDER.length === 0) {
    desc.innerHTML = `
      <span class="teal-text">Rizik</span> 1st &rarr;
      <span class="pink-text">Errichetti</span> 2nd &amp; 3rd &rarr;
      <span class="teal-text">Rizik</span> 4th &amp; 5th &rarr; ...alternating`;
    return;
  }
  const first = DRAFT_ORDER[0];
  const second = DRAFT_ORDER[1];
  const firstName = first === 'rizik' ? '<span class="teal-text">Rizik</span>' : '<span class="pink-text">Errichetti</span>';
  const secondName = second === 'rizik' ? '<span class="teal-text">Rizik</span>' : '<span class="pink-text">Errichetti</span>';
  desc.innerHTML = `${firstName} 1st &rarr; ${secondName} 2nd &amp; 3rd &rarr; ${firstName} 4th &amp; 5th &rarr; ...alternating`;
}

document.addEventListener('DOMContentLoaded', updateDraftOrderDesc);

function chooseDraftOrder(choice) {
  if (choice === 'pick') {
    DRAFT_ORDER = buildSnakeOrder('rizik', 'errichetti');
  } else {
    DRAFT_ORDER = buildSnakeOrder('errichetti', 'rizik');
  }
  updateDraftOrderDesc();
  startDraft();
}

// ==================== TIMER ====================
function startTimer() {
  stopTimer();
  timeLeft = 60;
  updateTimerDisplay();
  timerInterval = setInterval(() => {
    if (draftPaused) return;
    timeLeft--;
    updateTimerDisplay();
    if (timeLeft <= 0) {
      stopTimer();
      handleTimeout();
    } else if (timeLeft <= 10) {
      playCountdownBeep(timeLeft <= 5);
    }
  }, 1000);
}

function stopTimer() {
  if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
}

function updateTimerDisplay() {
  const display = document.getElementById('timer-display');
  const bar = document.getElementById('timer-bar-fill');
  const secs = Math.max(0, timeLeft);
  const mins = Math.floor(secs / 60);
  const s = secs % 60;
  display.textContent = `${mins}:${s.toString().padStart(2, '0')}`;

  const pct = (secs / 60) * 100;
  bar.style.width = pct + '%';

  if (secs <= 15) {
    display.classList.add('warning');
    bar.classList.add('warning');
  } else {
    display.classList.remove('warning');
    bar.classList.remove('warning');
  }
}

function handleTimeout() {
  const team = DRAFT_ORDER[currentPick];
  const teamName = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';

  // Close modal if open
  closeModal();
  stopDraftMusic();
  playTimeoutBuzzer();

  // Save this pick to the end
  pendingPicks.push({ team: team });

  // Show timeout flash
  const flash = document.getElementById('timeout-flash');
  document.getElementById('timeout-team').textContent = `${teamName} ran out of time`;
  flash.classList.add('active');

  draftPaused = true;
  setTimeout(() => {
    flash.classList.remove('active');
    draftPaused = false;
    currentPick++;
    renderPool();
    renderRosters();

    if (currentPick >= DRAFT_ORDER.length) {
      processPendingPicks();
    } else {
      updateDraftHeader();
      startTimer();
      startDraftMusic();
    }
  }, 2500);
}

function processPendingPicks() {
  if (pendingPicks.length === 0) {
    setTimeout(() => showResults(), 500);
    return;
  }

  // Get remaining undrafted players
  const undrafted = [];
  PLAYERS.forEach((p, i) => {
    if (!teams.rizik.includes(i) && !teams.errichetti.includes(i)) {
      undrafted.push(i);
    }
  });

  if (undrafted.length === 0) {
    setTimeout(() => showResults(), 500);
    return;
  }

  const pending = pendingPicks.shift();
  showPendingPickScreen(pending.team, undrafted);
}

function showPendingPickScreen(team, undrafted) {
  // Reuse the draft screen for penalty picks
  const teamName = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
  document.getElementById('pick-info').textContent = `PENALTY PICK`;
  const clock = document.getElementById('on-the-clock');
  clock.textContent = `${teamName} - Timed Out Pick`;
  clock.className = 'on-the-clock ' + team;
  clock.style.animation = 'none';

  // Hide timer for penalty picks
  document.getElementById('timer-display').textContent = '--:--';
  document.getElementById('timer-bar-fill').style.width = '0%';
  stopTimer();

  // Re-render pool to show only undrafted
  renderPool();
  renderRosters();

  // Start a fresh 60s timer for the penalty pick too
  startTimer();
  startDraftMusic();

  // Temporarily override the draft order for this pick
  window._penaltyTeam = team;
}

// ==================== DRAFT ====================
function startDraft() {
  showScreen('draft-screen');
  renderPool();
  renderRosters();
  updateDraftHeader();
  startTimer();
  startDraftMusic();
}

function getPhoto(player) {
  return player.photo || 'placeholder.png';
}

function renderPool() {
  const pool = document.getElementById('player-pool');
  pool.innerHTML = '';
  PLAYERS.forEach((p, i) => {
    const drafted = teams.rizik.includes(i) || teams.errichetti.includes(i);
    const card = document.createElement('div');
    card.className = 'player-card' + (drafted ? ' drafted' : '');
    card.onclick = drafted ? null : () => openModal(i);
    card.innerHTML = `
      <div class="player-card-inner">
        <img src="${getPhoto(p)}" alt="${p.name}">
        <div class="player-card-info">
          <div class="player-card-name">${p.name}</div>
          <div class="player-card-meta">${p.hometown}</div>
          <div class="player-card-handicap">${p.handicap}</div>
          <div class="player-card-strength">${p.strength}</div>
        </div>
      </div>
    `;
    pool.appendChild(card);
  });
}

function renderRosters() {
  ['rizik', 'errichetti'].forEach(team => {
    const container = document.getElementById(team + '-roster');
    container.innerHTML = '';
    for (let i = 0; i < 5; i++) {
      const slot = document.createElement('div');
      slot.className = 'roster-slot' + (teams[team][i] !== undefined ? ' filled' : '');
      if (teams[team][i] !== undefined) {
        const p = PLAYERS[teams[team][i]];
        slot.innerHTML = `<span class="slot-number">${i+1}.</span><span class="slot-name">${p.name}</span><span class="slot-hcp">${p.handicap}</span>`;
      } else {
        slot.innerHTML = `<span class="slot-number">${i+1}.</span><span style="color:var(--text-dim); font-size:0.8rem;">&mdash;</span>`;
      }
      container.appendChild(slot);
    }
  });
}

function updateDraftHeader() {
  if (currentPick >= DRAFT_ORDER.length) return;
  const team = DRAFT_ORDER[currentPick];
  const teamName = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
  document.getElementById('pick-info').textContent = `Pick ${currentPick + 1} of ${DRAFT_ORDER.length}`;
  const clock = document.getElementById('on-the-clock');
  clock.textContent = `${teamName} is on the clock`;
  clock.className = 'on-the-clock ' + team;
  clock.style.animation = '';
}

function openModal(playerIndex) {
  selectedPlayer = playerIndex;
  const p = PLAYERS[playerIndex];
  const team = window._penaltyTeam || DRAFT_ORDER[currentPick];
  document.getElementById('modal-photo').src = getPhoto(p);
  document.getElementById('modal-name').textContent = p.name;
  document.getElementById('modal-detail').textContent = `${p.hometown} â€¢ ${p.college}`;
  document.getElementById('modal-handicap').textContent = p.handicap;
  document.getElementById('modal-strength').textContent = p.strength;
  document.getElementById('modal-weakness').textContent = p.weakness;
  document.getElementById('modal-funfact').textContent = p.funfact;

  const btn = document.getElementById('modal-draft-btn');
  const teamName = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
  btn.textContent = `Draft to ${teamName}`;

  document.getElementById('draft-modal').classList.add('active');
}

function closeModal() {
  selectedPlayer = null;
  document.getElementById('draft-modal').classList.remove('active');
}

function confirmDraft() {
  if (selectedPlayer === null) return;
  const team = window._penaltyTeam || DRAFT_ORDER[currentPick];
  const player = PLAYERS[selectedPlayer];

  teams[team].push(selectedPlayer);
  closeModal();
  stopTimer();
  stopDraftMusic();

  draftPaused = true;

  // Phase 1: "THE PICK IS IN" overlay
  const pickIn = document.getElementById('pick-is-in');
  const teamName = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
  const pickInTeam = document.getElementById('pick-is-in-team');
  pickInTeam.textContent = teamName;
  pickInTeam.style.color = team === 'rizik' ? 'var(--teal)' : 'var(--pink)';
  pickInTeam.style.textShadow = team === 'rizik' ? '0 0 20px var(--teal-glow)' : '0 0 20px var(--pink-glow)';

  pickIn.classList.remove('active');
  void pickIn.offsetWidth;
  pickIn.classList.add('active');
  playPickIsInFanfare();

  // Phase 2: After "THE PICK IS IN", show the player name flash
  setTimeout(() => {
    pickIn.classList.remove('active');

    const flash = document.getElementById('draft-flash');
    document.getElementById('flash-name').textContent = player.name;
    const flashTeam = document.getElementById('flash-team');
    flashTeam.textContent = `â†’ ${teamName}`;
    flashTeam.style.color = team === 'rizik' ? 'var(--teal)' : 'var(--pink)';

    flash.classList.remove('active');
    void flash.offsetWidth;
    flash.classList.add('active');

    setTimeout(() => {
      flash.classList.remove('active');
      draftPaused = false;

      // If this was a penalty pick
      if (window._penaltyTeam) {
        window._penaltyTeam = null;
        renderPool();
        renderRosters();
        processPendingPicks();
        return;
      }

      currentPick++;
      renderPool();
      renderRosters();

      if (currentPick >= DRAFT_ORDER.length) {
        if (pendingPicks.length > 0) {
          processPendingPicks();
        } else {
          setTimeout(() => showResults(), 500);
        }
      } else {
        updateDraftHeader();
        startTimer();
        startDraftMusic();
      }
    }, 2500);
  }, 2800);
}

// ==================== RESULTS ====================
function showResults() {
  stopTimer();
  stopDraftMusic();
  window._penaltyTeam = null;
  showScreen('results-screen');
  renderResultsTeams();
  renderRatings();
  renderSuperlatives();
}

function renderResultsTeams() {
  const container = document.getElementById('results-teams');
  container.innerHTML = '';

  ['rizik', 'errichetti'].forEach(team => {
    const captain = CAPTAINS[team];
    const div = document.createElement('div');
    div.className = 'results-team ' + team;

    const teamLabel = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
    const avgHcp = getTeamAvgHandicap(team);

    let html = `<div class="results-team-name">${teamLabel} <span style="font-size:0.9rem; color:var(--text-dim)">(Avg HCP: ${avgHcp})</span></div>`;

    html += `<div class="results-player">
      <img src="${getPhoto(captain)}" alt="${captain.name}">
      <div class="results-player-info">
        <div class="results-player-name">${captain.name} <span style="color:var(--gold); font-size:0.8rem;">CPT</span></div>
        <div class="results-player-meta">${captain.strength}</div>
      </div>
      <div class="results-player-hcp">${captain.handicap}</div>
    </div>`;

    teams[team].forEach(idx => {
      const p = PLAYERS[idx];
      html += `<div class="results-player">
        <img src="${getPhoto(p)}" alt="${p.name}">
        <div class="results-player-info">
          <div class="results-player-name">${p.name}</div>
          <div class="results-player-meta">${p.strength}</div>
        </div>
        <div class="results-player-hcp">${p.handicap}</div>
      </div>`;
    });

    div.innerHTML = html;
    container.appendChild(div);
  });
}

function getTeamAvgHandicap(team) {
  const captain = CAPTAINS[team];
  const hcps = [captain.handicap, ...teams[team].map(i => PLAYERS[i].handicap)];
  return (hcps.reduce((a,b) => a+b, 0) / hcps.length).toFixed(1);
}

function getTeamPlayers(team) {
  return [CAPTAINS[team], ...teams[team].map(i => PLAYERS[i])];
}

// ==================== TEAM RATINGS ====================
function calcRating(team, category) {
  const players = getTeamPlayers(team);
  const allText = players.map(p => `${p.strength} ${p.weakness} ${p.funfact}`).join(' ').toLowerCase();

  switch(category) {
    case 'party': {
      const keywords = ['beer','fireball','drunk','spleef','k hole','flip cup','olympics','sleeping','hungover','shots'];
      const hits = keywords.filter(k => allText.includes(k)).length;
      return Math.min(10, Math.max(2, Math.round(hits * 2.5 + 1)));
    }
    case 'firepower': {
      const avg = parseFloat(getTeamAvgHandicap(team));
      return Math.min(10, Math.max(2, Math.round(11 - (avg - 9) * 0.6)));
    }
    case 'wildcard': {
      const keywords = ['mad','yips','wild','hungover','injured','drunk','anywhere','questionable','forgetting','prone'];
      const hits = keywords.filter(k => allText.includes(k)).length;
      return Math.min(10, Math.max(2, Math.round(hits * 1.8 + 2)));
    }
    case 'clutch': {
      const keywords = ['top dawg','big game','clinical','specialist','strategist','undefeated','dad strength','swaggiest','longest','bombs'];
      const hits = keywords.filter(k => allText.includes(k)).length;
      return Math.min(10, Math.max(2, Math.round(hits * 2 + 2)));
    }
    case 'vibes': {
      const keywords = ['heart','magic','host','love','most','beesh','nadal','locked in','swag','czar'];
      const hits = keywords.filter(k => allText.includes(k)).length;
      return Math.min(10, Math.max(3, Math.round(hits * 2 + 3)));
    }
  }
  return 5;
}

function renderRatings() {
  const section = document.getElementById('ratings-section');
  const categories = [
    { key: 'firepower', label: 'Firepower' },
    { key: 'party', label: 'Party Rating' },
    { key: 'clutch', label: 'Clutch Gene' },
    { key: 'wildcard', label: 'Wildcard Factor' },
    { key: 'vibes', label: 'Vibes' },
  ];

  let html = '<div class="ratings-title arcade-text">Team Ratings</div>';
  html += '<div class="ratings-grid">';

  ['rizik', 'errichetti'].forEach(team => {
    const teamLabel = team === 'rizik' ? 'Team Rizik' : 'Team Errichetti';
    const barClass = team === 'rizik' ? 'teal' : 'pink';

    html += `<div class="rating-card">`;
    html += `<div class="rating-card-title">${teamLabel}</div>`;

    categories.forEach(cat => {
      const val = calcRating(team, cat.key);
      const pct = val * 10;
      html += `<div class="rating-row">
        <div class="rating-label">${cat.label}</div>
        <div class="rating-bar-track">
          <div class="rating-bar-fill ${barClass}" style="width:${pct}%"></div>
        </div>
        <div class="rating-value">${val}</div>
      </div>`;
    });

    html += '</div>';
  });

  html += '</div>';
  section.innerHTML = html;
}

// ==================== SUPERLATIVES ====================
function renderSuperlatives() {
  const allPlayers = PLAYERS.map((p, i) => ({...p, idx: i}));
  const captainPlayers = [
    {...CAPTAINS.rizik, team: 'rizik'},
    {...CAPTAINS.errichetti, team: 'errichetti'},
  ];
  const everyone = [...allPlayers, ...captainPlayers];

  const superlatives = [
    {
      label: "Most Likely to Find the Bar Before the 10th Hole",
      pick: () => {
        const keywords = ['drunk','beer','fireball','k hole','spleef','shots'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.weakness}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
    {
      label: "Most Likely to Start a Fight with the Cart Girl",
      pick: () => {
        const keywords = ['mad','mad','angry'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.weakness}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
    {
      label: "Best Vibes on the Course",
      pick: () => {
        const keywords = ['heart','host','magic','swag','czar','beesh'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.strength}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
    {
      label: "Most Likely to Blame the Equipment",
      pick: () => {
        const keywords = ['yips','wild','anywhere','driver','ankle','injured'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.weakness}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
    {
      label: "Secret Weapon",
      pick: () => {
        const keywords = ['undefeated','specialist','strategist','top dawg','big game','clinical','dad strength'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.strength}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
    {
      label: "Most Likely to Disappear on the Back Nine",
      pick: () => {
        const keywords = ['k hole','sleeping','drunk','spleef','hungover','forgetting'];
        return everyone.reduce((best, p) => {
          const text = `${p.funfact} ${p.weakness}`.toLowerCase();
          const hits = keywords.filter(k => text.includes(k)).length;
          return hits > best.score ? {name: p.name, score: hits} : best;
        }, {name: '', score: -1}).name;
      }
    },
  ];

  const container = document.getElementById('superlatives');
  let html = '<div class="superlatives-title arcade-text">Superlatives</div>';
  superlatives.forEach(s => {
    html += `<div class="superlative-item">
      <span class="superlative-label">${s.label}</span>
      <span class="superlative-winner">${s.pick()}</span>
    </div>`;
  });
  container.innerHTML = html;
}

// ==================== RESET ====================
function resetDraft() {
  stopTimer();
  stopDraftMusic();
  currentPick = 0;
  selectedPlayer = null;
  teams.rizik = [];
  teams.errichetti = [];
  DRAFT_ORDER = [];
  pendingPicks.length = 0;
  window._penaltyTeam = null;
  draftPaused = false;
  showScreen('title-screen');
}
</script>
</body>
</html>
